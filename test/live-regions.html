<!DOCTPYE html>
<html lang="fr">
    <head>
        <title>Live Regions</title>
    </head>
    <body>
        <h1>Live Regions</h1>

<pre>
    aria-live=polite/assertive - announce after current task, low priority vs immediate

    role=log - announce ordered content, may be removed

    # TODO
    aria-atomic=true/(false, default) - include all content, or only changed content
    aria-relevant=(additions text, default) (removals/all, limit) - what consider as a change?

    role=alert - interrupt accounce (assertive)
    role=alertdialog - alert but w/ el to focus
    role=marquee - frequent changes, low importance
    role=timer - numerical counter elapsed from start to remaning until an end
</pre>

        <section aria-labelledby="live-label">
            <h1 id="live-label">aria-live=polite</h1>
            <label>Polite updates <button id="live-polite-button">start</button></label>
            <div aria-live=polite aria-relevant="additions text" aria-atomic="false" id="live-polite"></div>
<pre>
Notes:
- aria-relevant considers "additions" as Block (div..) vs. "text" as Inline (span, text..)
- aria-atomic=false is ignored for Inline and regardless reads all content on any update
</pre>
        </section>

        <section>
            <h1>aria-live=assertive</h1>
            <label>Assertive updates <button id="live-assertive-button">start</button></label>
            <div aria-live=assertive id="live-assertive"></div>
<pre>
Notes: 
- Assertive should interrupt and play before Polite. Polite updates interrupted should queue and play at next natural time
</pre>
        </section>

        <section>
            <h1>role=log</h1>
            <div>
                <label>Add a message to a log <button id="role-log-button">add</button></label>
                <ul role=log id="role-log-el"></div>
            </div>
<pre>
Notes: 
- polite default so announcement may get dropped if other stuff announcing (should queue though right?)
</pre>
        </section>


        <script>
            document.addEventListener('DOMContentLoaded', function() {

                //live-polite
                const livePolite = document.querySelector('#live-polite');
                const livePoliteButton = document.querySelector('#live-polite-button');
                livePoliteButton.addEventListener('click', function() {
                    let n = 1;
                    (function update() {
                        // Span/textNode treated as Inline & read as whole
                        // const el = document.createTextNode(' ' + n++);
                        const el = document.createElement('div');
                        el.appendChild(document.createTextNode(n++));
                        el.style.display = 'inline-block';
                        livePolite.appendChild(el);
                        if (n <= 50) { 
                            setTimeout(update, 1000);
                        }
                    })();
                });

                //live-assertive
                const liveAssertive = document.querySelector('#live-assertive');
                const liveAssertiveButton = document.querySelector('#live-assertive-button');
                liveAssertiveButton.addEventListener('click', function() {
                    let n = 1;
                    (function update() {
                        const el = document.createElement('div');
                        el.appendChild(document.createTextNode('a'));
                        el.style.display = 'inline-block';
                        liveAssertive.appendChild(el);
                        if (n <= 20) {
                            n++; 
                            setTimeout(update, 2000);
                        }
                    })();
                });
            });


            //role-log
            const roleLogContent = document.querySelector('#role-log-el');
            const roleLogButton  = document.querySelector('#role-log-button');
            roleLogButton.addEventListener('click', function() {
                const liEl = document.createElement('li');
                liEl.appendChild(document.createTextNode('added a list element'));
                roleLogContent.appendChild(liEl);
            });


            // function update(el, content) {
            //     return function() {
            //         el.innerHtml += content
            //     }
            // }

            // function repeatUpdate(update, delay, condition) {
            //     update();
            //     if (typeof condition === undefined || !condition) { return }
            //     setTimeout(repeatUpdate, delay);
            // }
        </script>
    </body>
</html>